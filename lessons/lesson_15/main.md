# POETRY
Система зависимостей - никогда не сохраняем зависимости в requirements.txt
(*Только для маленьких проектов)

### **Pyenv**  
для управления версиями Python (устанавливать/удалять/переключаться между версиями)  
https://github.com/pyenv/pyenv

### Poetry
для управления зависимостями, их версиями и тд. (если например нам нужна определенная версия библиотеки,
poetry может автоматически установить эту версию и соответствующие зависимости, которые требуются для работы этой версии)

Также, можно распространять свои зависимости с помощью poetry, например в pypi  
https://pypi.org - для поиска/установки пакетов (общий репозиторий для пакетов)


### Eсли мы не хотим работать с poetry как с дистрибьютором пакетов:
`[tool.poetry]`  
`package-mode = false`

Если создаем новый проект:  
`poetry new fastapi-greet-app`

Если инициализируем существующий проект:  
`poetry init `  
(создает файл pyproject.toml в текущей директории)

_**pyproject.toml**_ - основной файл конфигурации проекта

`poetry add <library_name>` - добавляем зависимость и устанавливаем ее  
`poetry show --tree` - показать дерево зависимостей  
`poetry add "pydantic[email]"` - добавить библиотеку pydantic с расширением email  
`poetry lock`- фиксирует версии зависимостей, указанные в _pyproject.toml_  
то есть файл _poetry.lock_ создается на основе файла конфигурации _pyproject.toml_

`poetry lock --no-update` - пересоздает файд lock с версиями зависимостей, указанными в _pyproject.toml_  
**_пересоздается без обновления до более новых версий если они доступны_**

Можно зафиксировать текущую версию через `==`  
`fastapi = "==0.110.1"`  
`uvicorn = "==0.29.0"`

`poetry install` - установить все зависимости, согласно файлу конфигурации

# DOCKER

_**При создании контейнера нужно исключить создание виртуального окружения,
так как 1 контейнер = 1 приложение**_
`RUN poetry config virtualenvs.create false --local`

**_Все образы для контейнеров доступны тут:_**
_https://hub.docker.com_

`docker run -it ubuntu bash` - запустить контейнер с образом ubuntu (если нет образа ubuntu - загрузит)
`-it` - запустить интерактивно (то есть можно нажимать кнопки в cmd)  
`neofetch` - посмотреть информацию о системе  
`df -h` - информация о дисковом пространстве на файловых системах (Ubuntu/Linux/Mac)  
`docker ps -a` - показать все контейнеры  
`docker start 5cd994bf719e -i` - запустить определенный контейнер  
`docker run -it python bash` - контейнер с python

## Dockerfile
В Dockerfile сверху прописываем то, что используем/меняем редко, а снизу то, что меняем быстро и часто
Чтение идет сверху вниз (в случае отсутствия изменений, чтение будет только того, что изменилось. неизмененные данные берутся из кеша)

`docker build . -t web` - создать образ web согласно docker файлу
`docker run -it <image_name>`- запустить контейнер
`docker run -p <HOST_PORT>:<CONTAINER_PORT> -it <name>`- запустить контейнер  
пример: `docker run -p 8000:8000 -it web`

